(this["webpackJsonpprototype-sashimi"]=this["webpackJsonpprototype-sashimi"]||[]).push([[0],{173:function(e,t,c){"use strict";c.r(t);var n=c(66),a=c(0),r=function(){return Object(a.jsx)("header",{children:Object(a.jsx)("div",{className:"hero is-success",children:Object(a.jsxs)("div",{className:"hero-body",children:[Object(a.jsx)("p",{className:"title",children:"furu-vis"}),Object(a.jsx)("p",{className:"subtitle",children:"furu-vis"})]})})})},s=c(3),i=c(7),o=c(4),l=c.n(o),j=c(68),u=c(2),d=c(1);var b=function(e){var t=e.children,c=(e.width,e.height,Object(d.useRef)()),n=Object(d.useState)(1),r=Object(s.a)(n,2),i=r[0],o=r[1],l=Object(d.useState)(0),j=Object(s.a)(l,2),b=j[0],h=j[1],x=Object(d.useState)(0),O=Object(s.a)(x,2),p=O[0],f=O[1];return Object(d.useEffect)((function(){var e=u.i().on("zoom",(function(e){var t=e.transform,c=t.x,n=t.y,a=t.k;o(a),h(c),f(n)}));e.scaleExtent([.5,2]),u.h(c.current).call(e)}),[]),Object(a.jsx)("svg",{ref:c,viewBox:"-50 0 770 325",width:"800",height:"600",children:Object(a.jsx)("g",{transform:"translate(".concat(b,", ").concat(p,")scale(").concat(i,")"),children:t})})},h=function(e){var t=e.currentArea,c=Object(d.useState)([]),n=Object(s.a)(c,2),r=n[0],o=n[1],h=Object(d.useState)(null),x=Object(s.a)(h,2),O=x[0],p=x[1],f=Object(d.useState)(null),g=Object(s.a)(f,2),m=g[0],v=g[1],y=Object(d.useState)([]),k=Object(s.a)(y,2),N=k[0],w=k[1],S=u.c().center([135.355972,37.2008335]).translate([315,190]).scale(1680);return Object(d.useEffect)((function(){Object(i.a)(l.a.mark((function e(){var t,c,n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/japan_simplify.topojson");case 2:return t=e.sent,e.next=5,t.json();case 5:return c=e.sent,e.next=8,j.a(c,c.objects["N03-21_210101-N03-21_210101"]);case 8:n=e.sent,a=u.d().projection(S),r=[],n.features.map((function(e){r.push({path:a(e),areaCode:e.properties.N03_007})})),o(r),v(n);case 14:case"end":return e.stop()}}),e)})))()}),[]),Object(d.useEffect)((function(){if(m){var e=JSON.parse(JSON.stringify(m)),c=String(t).slice(0,-1);e.features.length=0,e.features=m.features.filter((function(e){return e.properties.N03_007==c})),console.log("area\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f"),null!=t&&console.log(t);var n=S(u.b(e));w(n),p(t)}}),[t]),r.length?Object(a.jsx)("div",{className:"column is-5",style:{marginLeft:"20px",marginRight:"10px"},children:Object(a.jsx)("div",{className:"box",children:Object(a.jsxs)(b,{width:500,height:500,children:[Object(a.jsx)("g",{children:r.map((function(e,t){return Object(a.jsx)("path",{d:e.path,stroke:"black",strokeWidth:"0.8",strokeOpacity:"0.5",style:{fill:O==e.areaCode?"red":"white"}},t)}))}),N.length>0?Object(a.jsx)("g",{children:Object(a.jsx)("circle",{cx:N[0],cy:N[1],r:"15",strokeWidth:"4",fill:"rgba(255,0,0,0)",stroke:"red"})}):""]})})}):Object(a.jsx)("div",{className:"column is-5",children:Object(a.jsx)("div",{className:"box",children:Object(a.jsx)("p",{children:"loading"})})})},x=function(e){var t=e.scale,c=e.graphHeight,n=e.label,r="#888",i=t.range(),o=Object(s.a)(i,2),l=o[0],j=o[1],u=window.innerWidth;return Object(a.jsxs)("g",{children:[Object(a.jsx)("line",{x1:0,y1:l,x2:0,y2:j+2,stroke:r,strokeWidth:"2"}),Object(a.jsxs)("g",{children:[Object(a.jsx)("g",{transform:"translate(-80, ".concat(c/2,") rotate(-90)"),children:Object(a.jsx)("text",{x:"0",y:"0",textAnchor:"end",dominantBaseline:"central",fontSize:u>768?"15":"12",children:n})}),t.ticks().map((function(e,c){return Object(a.jsxs)("g",{transform:"translate(0, ".concat(t(e),")"),children:[Object(a.jsx)("line",{x1:"0",y1:"0",x2:"5",y2:"0",stroke:r}),Object(a.jsx)("text",{x:"-8",y:"0",textAnchor:"end",dominantBaseline:"central",fill:"black",fontSize:u>768?"12":"10",children:e})]},c)}))]})]})},O=function(e){var t=e.scale,c=e.graphWidth,n=e.graphHeight,r=e.label,i=e.setData,o=e.graphType,l=e.optionData,j=n,u=(window.innerWidth,"year"===o?10:20),d=t.range(),b=Object(s.a)(d,2),h=b[0],x=b[1],O=function(e){i(e.currentTarget.dataset.id)};return Object(a.jsxs)("g",{children:[Object(a.jsx)("line",{x1:h,y1:j,x2:x+25,y2:j,stroke:"#888"}),Object(a.jsxs)("g",{children:[Object(a.jsx)("g",{transform:"translate(".concat(c/2,", ").concat(j+40,")"),children:Object(a.jsx)("text",{x:"0",y:"0",textAnchor:"end",dominantBaseline:"central",fontSize:"15",children:r})}),t.ticks(u).map((function(e,c){return Object(a.jsx)("g",{transform:"translate(".concat(t(e)+20,", 0)"),children:Object(a.jsx)("text",{x:"0",y:j+15,textAnchor:"middle",dominantBaseline:"central",fontSize:"area"!==o?"12":"5","data-id":"area"!==o||20===c?e:l[c].id,onClick:O,children:"area"!==o||20===c?e:l[c].area})},c)}))]})]})},p=function(e){var t=e.setYear,c=Object(d.useState)([]),n=Object(s.a)(c,2),r=n[0],o=n[1],j=Object(d.useState)([]),b=Object(s.a)(j,2),h=b[0],p=b[1],f=u.f(u.g);if(Object(d.useEffect)((function(){Object(i.a)(l.a.mark((function e(){var t,c,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/population_test.json");case 2:return t=e.sent,e.next=5,t.json();case 5:return c=e.sent,o(c),e.next=9,fetch("./data/price_test.json");case 9:return n=e.sent,e.next=12,n.json();case 12:a=e.sent,p(a);case 14:case"end":return e.stop()}}),e)})))()}),[]),0===h.length)return Object(a.jsx)("div",{className:"column is-5",children:"Loading..."});var g=0,m=200,v=250,y=50+m+300,k=g+50+v,N=u.e().domain(u.a(h,(function(e){return e.year}))).range([0,300]),w=u.e().domain([0,u.a(r,(function(e){return e.population}))[1]]).range([v,0]),S=u.e().domain([0,u.a(h,(function(e){return e.price}))[1]]).range([v,0]);return Object(a.jsx)("div",{className:"box",children:Object(a.jsx)("div",{children:Object(a.jsxs)("svg",{viewBox:"".concat(-m," ").concat(-g," ").concat(y," ").concat(k),width:y,height:k,children:[Object(a.jsx)(O,{scale:N,graphWidth:300,graphHeight:v,label:"\u5e74",setData:t,graphType:"year"}),Object(a.jsx)(x,{scale:S,graphHeight:v,label:"\u53d7\u3051\u5165\u308c\u984d"}),Object(a.jsx)("g",{children:h.map((function(e,t){var c=N(e.year)+20,n=S(e.price);return Object(a.jsx)("path",{d:"M ".concat(c-10," ").concat(n,"\n                       H ").concat(c+10," V ").concat(v," H ").concat(c-10," \n                      V ").concat(n,"\n                      "),stroke:f("price"),fill:f("price")},e.id)}))}),Object(a.jsx)("g",{children:r.map((function(e,t){var c=t>0?r[t-1]:null;if(t>0)return Object(a.jsxs)("g",{children:[Object(a.jsx)("line",{x1:N(c.year),y1:w(c.population),x2:N(e.year),y2:w(e.population),stroke:f("population")},10*e.id),Object(a.jsx)("circle",{cx:N(e.year),cy:w(e.population),r:"2",fill:f("population")},e.id)]},100*e.id)}))})]})})})},f=function(e){var t=e.setArea,c=e.year,n=Object(d.useState)([]),r=Object(s.a)(n,2),o=r[0],j=r[1],b=0,h=200,p=250,f=50+h+500,g=b+50+p;if(Object(d.useEffect)((function(){Object(i.a)(l.a.mark((function e(){var t,c,n,a,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},c=2008,n=20;case 3:if(!(n<33)){e.next=17;break}return a=n<=30?"H"+n:"R"+(n-30),e.next=7,fetch("./data/".concat(a,".json"));case 7:return r=e.sent,e.next=10,r.json();case 10:s=e.sent,console.log(s),t[c]=s,c++;case 14:n++,e.next=3;break;case 17:j(t);case 18:case"end":return e.stop()}}),e)})))()}),[]),0===o.length)return console.log("\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u4e2d"),Object(a.jsx)("div",{});if(!c)return console.log("\u5e74\u5ea6\u304c\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),Object(a.jsx)("div",{className:"column is-5",children:"Loading..."});console.log("data detail"),console.log(o);var m=o[c].map((function(e){return{id:e.id,area:e.area}}));console.log("ojb"),console.log(m);var v=u.e().domain(u.a([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).range([500,0]),y=u.e().domain([0,u.a(o[c],(function(e){return e.price}))[1]]).range([p,0]),k=u.e().domain([0,u.a(o[c],(function(e){return e.population}))[1]]).range([p,0]);return Object.keys(o).length?Object(a.jsx)("div",{className:"box",style:{marginTop:"0"},children:Object(a.jsxs)("svg",{viewBox:"".concat(-h," ").concat(-b," ").concat(f," ").concat(g),width:f,height:g,children:[Object(a.jsx)("g",{children:o[c].map((function(e,t){var c=v(t),n=y(e.price);return Object(a.jsx)("path",{d:"M ".concat(c-10," ").concat(n,"\n                   H ").concat(c+10," V ").concat(p," H ").concat(c-10," \n                  V ").concat(n,"\n                  ")},e.id)}))}),Object(a.jsx)("g",{children:o[c].map((function(e,t){var n=t>0?o[c][t-1]:null;if(t>0)return Object(a.jsxs)("g",{children:[Object(a.jsx)("line",{x1:v(t-1),y1:k(n.population),x2:v(t),y2:k(e.population),stroke:"black"},10*e.id),Object(a.jsx)("circle",{cx:v(e.year),cy:k(e.population),r:"2",fill:"black"},e.id)]},100*e.id)}))}),Object(a.jsx)(x,{scale:y,graphHeight:p,label:"\u53d7\u3051\u5165\u308c\u91d1\u984d"}),Object(a.jsx)(O,{scale:v,graphWidth:500,graphHeight:p,label:"\u5e02\u533a\u753a\u6751",setData:t,graphType:"area",optionData:m})]})}):void 0},g=function(){var e=Object(d.useState)(null),t=Object(s.a)(e,2),c=t[0],n=t[1],r=Object(d.useState)(null),i=Object(s.a)(r,2),o=i[0],l=i[1];return Object(a.jsxs)("div",{className:"columns is-multiline",style:{marginTop:"10px"},children:[Object(a.jsx)(h,{currentArea:c}),Object(a.jsxs)("div",{className:"column is-6",children:[Object(a.jsx)(p,{setYear:l}),Object(a.jsx)(f,{setArea:n,year:o})]})]})},m=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("div",{className:"content has-text-centered",children:Object(a.jsx)("p",{children:"Furu-Vis"})})})},v=(c(172),function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(r,{}),Object(a.jsx)(g,{}),Object(a.jsx)(m,{})]})});Object(n.render)(Object(a.jsx)(v,{}),document.querySelector("#content"))}},[[173,1,2]]]);
//# sourceMappingURL=main.a30032b5.chunk.js.map