(this["webpackJsonpprototype-sashimi"]=this["webpackJsonpprototype-sashimi"]||[]).push([[0],{173:function(e,t,c){"use strict";c.r(t);var n=c(66),a=c(0),r=function(){return Object(a.jsx)("header",{children:Object(a.jsx)("div",{className:"hero is-success",children:Object(a.jsxs)("div",{className:"hero-body",children:[Object(a.jsx)("p",{className:"title",children:"furu-vis"}),Object(a.jsx)("p",{className:"subtitle",children:"furu-vis"})]})})})},s=c(2),i=c(7),o=c(4),j=c.n(o),l=c(68),u=c(3),d=c(1);var b=function(e){var t=e.children,c=(e.width,e.height,Object(d.useRef)()),n=Object(d.useState)(1),r=Object(s.a)(n,2),i=r[0],o=r[1],j=Object(d.useState)(0),l=Object(s.a)(j,2),b=l[0],h=l[1],x=Object(d.useState)(0),O=Object(s.a)(x,2),f=O[0],p=O[1];return Object(d.useEffect)((function(){var e=u.i().on("zoom",(function(e){var t=e.transform,c=t.x,n=t.y,a=t.k;o(a),h(c),p(n)}));e.scaleExtent([.5,2]),u.h(c.current).call(e)}),[]),Object(a.jsx)("svg",{ref:c,viewBox:"-50 0 770 325",width:"800",height:"600",children:Object(a.jsx)("g",{transform:"translate(".concat(b,", ").concat(f,")scale(").concat(i,")"),children:t})})},h=function(e){var t=e.currentArea,c=Object(d.useState)([]),n=Object(s.a)(c,2),r=n[0],o=n[1],h=Object(d.useState)(null),x=Object(s.a)(h,2),O=x[0],f=x[1],p=Object(d.useState)(null),g=Object(s.a)(p,2),m=g[0],v=g[1],y=Object(d.useState)([]),k=Object(s.a)(y,2),N=k[0],w=k[1],S=u.c().center([135.355972,37.2008335]).translate([315,190]).scale(1680);return Object(d.useEffect)((function(){Object(i.a)(j.a.mark((function e(){var t,c,n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/japan_simplify.topojson");case 2:return t=e.sent,e.next=5,t.json();case 5:return c=e.sent,e.next=8,l.a(c,c.objects["N03-21_210101-N03-21_210101"]);case 8:n=e.sent,a=u.d().projection(S),r=[],n.features.map((function(e){r.push({path:a(e),areaCode:e.properties.N03_007})})),o(r),v(n);case 14:case"end":return e.stop()}}),e)})))()}),[]),Object(d.useEffect)((function(){if(m){var e=JSON.parse(JSON.stringify(m)),c=String(t).slice(0,-1);e.features.length=0,e.features=m.features.filter((function(e){return e.properties.N03_007==c}));var n=S(u.b(e));w(n),f(t)}}),[t]),r.length?Object(a.jsx)("div",{className:"column is-7",style:{marginLeft:"10px"},children:Object(a.jsx)("div",{className:"box",children:Object(a.jsxs)(b,{width:500,height:500,children:[Object(a.jsx)("g",{children:r.map((function(e,t){return Object(a.jsx)("path",{d:e.path,stroke:"black",strokeWidth:"0.8",strokeOpacity:"0.5",style:{fill:O==e.areaCode?"red":"white"}},t)}))}),N.length>0?Object(a.jsx)("g",{children:Object(a.jsx)("circle",{cx:N[0],cy:N[1],r:"15",strokeWidth:"4",fill:"rgba(255,0,0,0)",stroke:"red"})}):""]})})}):Object(a.jsx)("div",{className:"column is-5",children:Object(a.jsx)("div",{className:"box",children:Object(a.jsx)("p",{children:"loading"})})})},x=function(e){var t=e.scale,c=e.graphHeight,n=e.label,r="#888",i=t.range(),o=Object(s.a)(i,2),j=o[0],l=o[1],u=window.innerWidth;return Object(a.jsxs)("g",{children:[Object(a.jsx)("line",{x1:0,y1:j,x2:0,y2:l+2,stroke:r,strokeWidth:"2"}),Object(a.jsxs)("g",{children:[Object(a.jsx)("g",{transform:"translate(-80, ".concat(c/2,") rotate(-90)"),children:Object(a.jsx)("text",{x:"0",y:"0",textAnchor:"end",dominantBaseline:"central",fontSize:u>768?"15":"12",children:n})}),t.ticks().map((function(e,c){return Object(a.jsxs)("g",{transform:"translate(0, ".concat(t(e),")"),children:[Object(a.jsx)("line",{x1:"0",y1:"0",x2:"5",y2:"0",stroke:r}),Object(a.jsx)("text",{x:"-8",y:"0",textAnchor:"end",dominantBaseline:"central",fill:"black",fontSize:u>768?"12":"10",children:e})]},c)}))]})]})},O=function(e){var t=e.scale,c=e.graphWidth,n=e.graphHeight,r=e.label,i=e.setData,o=e.graphType,j=e.optionData;"area"===o&&(console.log("it is area"),console.log(j));var l=n,u=(window.innerWidth,"year"===o?10:20),d=t.range(),b=Object(s.a)(d,2),h=b[0],x=b[1],O=function(e){console.log("year set"+e.currentTarget.dataset.id),i(e.currentTarget.dataset.id)};return Object(a.jsxs)("g",{children:[Object(a.jsx)("line",{x1:h,y1:l,x2:x+25,y2:l,stroke:"#888"}),Object(a.jsxs)("g",{children:[Object(a.jsx)("g",{transform:"translate(".concat(c/2,", ").concat(l+40,")"),children:Object(a.jsx)("text",{x:"0",y:"0",textAnchor:"end",dominantBaseline:"central",fontSize:"15",children:r})}),t.ticks(u).map((function(e,c){return console.log(c),Object(a.jsx)("g",{transform:"translate(".concat(t(e)+20,", 0)"),children:Object(a.jsx)("text",{x:"0",y:l+15,textAnchor:"middle",dominantBaseline:"central",fontSize:"area"!==o?"12":"5","data-id":"area"!==o||20===c?e:j[c].id,onClick:O,children:"area"!==o||20===c?e:j[c].name})},c)}))]})]})},f=function(e){var t=e.setYear,c=Object(d.useState)([]),n=Object(s.a)(c,2),r=n[0],o=n[1],l=Object(d.useState)([]),b=Object(s.a)(l,2),h=b[0],f=b[1],p=Object(d.useState)(null),g=Object(s.a)(p,2),m=g[0],v=(g[1],u.f(u.g));if(Object(d.useEffect)((function(){Object(i.a)(j.a.mark((function e(){var t,c,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/population_test.json");case 2:return t=e.sent,e.next=5,t.json();case 5:return c=e.sent,o(c),e.next=9,fetch("./data/price_test.json");case 9:return n=e.sent,e.next=12,n.json();case 12:a=e.sent,f(a);case 14:case"end":return e.stop()}}),e)})))()}),[]),0===h.length)return Object(a.jsx)("div",{className:"column is-5",children:"Loading..."});var y=50,k=200,N=500,w=50+k+300,S=y+50+N,H=u.e().domain(u.a(h,(function(e){return e.year}))).range([0,300]),A=(u.e().domain([0,u.a(r,(function(e){return e.population}))[1]]).range([N,0]),u.e().domain([0,u.a(h,(function(e){return e.price}))[1]]).range([N,0]));console.log(H.ticks(10));return Object(a.jsx)("div",{className:"column is-5",children:Object(a.jsxs)("div",{className:"box",children:[null===m?Object(a.jsx)("div",{children:Object(a.jsxs)("svg",{viewBox:"".concat(-k," ").concat(-y," ").concat(w," ").concat(S),width:w,height:S,children:[Object(a.jsx)(O,{scale:H,graphWidth:300,graphHeight:N,label:"\u5e74",setData:t,graphType:"year"}),Object(a.jsx)(x,{scale:A,graphHeight:N,label:"\u53d7\u3051\u5165\u308c\u984d"}),Object(a.jsx)("g",{children:h.map((function(e,t){var c=H(e.year)+20,n=A(e.price);return console.log(H(e.year)),Object(a.jsx)("path",{d:"M ".concat(c-10," ").concat(n,"\n                       H ").concat(c+10," V ").concat(N," H ").concat(c-10," \n                      V ").concat(n,"\n                      "),stroke:v("price"),fill:v("price")},e.id)}))})]})}):"",Object(a.jsxs)("div",{children:[Object(a.jsx)("span",{children:"\u5e74\u5ea6\u3092\u9078\u629e"}),Object(a.jsx)("button",{onClick:function(e){t(2019)},children:"2019"})]})]})})},p=function(e){var t=e.setArea,c=e.year,n=Object(d.useState)([]),r=Object(s.a)(n,2),o=r[0],l=r[1],b=50,h=200,f=500,p=50+h+500,g=b+50+f;if(Object(d.useEffect)((function(){Object(i.a)(j.a.mark((function e(){var t,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/2019_test.json");case 2:return t=e.sent,e.next=5,t.json();case 5:c=e.sent,l(c);case 7:case"end":return e.stop()}}),e)})))()}),[]),0===o.length)return Object(a.jsx)("div",{});var m=o.map((function(e){return{name:e.name,id:e.id}})),v=u.e().domain([0,u.a(o,(function(e){return e.rank}))[1]]).range([0,500]),y=u.e().domain([0,u.a(o,(function(e){return e.price}))[1]]).range([f,0]);return c&&0===o.length?Object(a.jsx)("div",{className:"column is-5",children:"Loading..."}):o.length?Object(a.jsx)("div",{className:"column is-5",children:Object(a.jsx)("div",{className:"box",children:Object(a.jsxs)("svg",{viewBox:"".concat(-h," ").concat(-b," ").concat(p," ").concat(g),width:p,height:g,children:[Object(a.jsx)("g",{children:o.map((function(e,t){var c=v(e.rank),n=y(e.price);return Object(a.jsx)("path",{d:"M ".concat(c-10," ").concat(n,"\n                   H ").concat(c+10," V ").concat(f," H ").concat(c-10," \n                  V ").concat(n,"\n                  ")},e.id)}))}),Object(a.jsx)(x,{scale:y,graphHeight:f,label:"\u53d7\u3051\u5165\u308c\u91d1\u984d"}),Object(a.jsx)(O,{scale:v,graphWidth:500,graphHeight:f,label:"\u5e02\u533a\u753a\u6751\uff08\u9806\u4f4d\uff09",setData:t,graphType:"area",optionData:m})]})})}):void 0},g=function(){var e=Object(d.useState)(null),t=Object(s.a)(e,2),c=t[0],n=t[1],r=Object(d.useState)(null),i=Object(s.a)(r,2),o=i[0],j=i[1];return Object(a.jsxs)("div",{className:"columns is-multiline",style:{marginTop:"10px"},children:[Object(a.jsx)(h,{currentArea:c}),Object(a.jsx)(f,{setYear:j}),Object(a.jsx)(p,{setArea:n,year:o})]})},m=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("div",{className:"content has-text-centered",children:Object(a.jsx)("p",{children:"Furu-Vis"})})})},v=(c(172),function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(r,{}),Object(a.jsx)(g,{}),Object(a.jsx)(m,{})]})});Object(n.render)(Object(a.jsx)(v,{}),document.querySelector("#content"))}},[[173,1,2]]]);
//# sourceMappingURL=main.b8cb2243.chunk.js.map