(this["webpackJsonpprototype-sashimi"]=this["webpackJsonpprototype-sashimi"]||[]).push([[0],{173:function(e,t,c){"use strict";c.r(t);var n=c(66),a=c(0),r=function(){return Object(a.jsx)("header",{children:Object(a.jsx)("div",{className:"hero is-small is-success",children:Object(a.jsxs)("div",{className:"hero-body",children:[Object(a.jsx)("p",{className:"title",children:"furu-vis"}),Object(a.jsx)("p",{className:"subtitle",children:"furu-vis"})]})})})},s=c(3),i=c(7),o=c(4),l=c.n(o),j=c(68),u=c(2),d=c(1);var h=function(e){var t=e.children,c=(e.width,e.height,Object(d.useRef)()),n=Object(d.useState)(1),r=Object(s.a)(n,2),i=r[0],o=r[1],l=Object(d.useState)(0),j=Object(s.a)(l,2),h=j[0],b=j[1],x=Object(d.useState)(0),O=Object(s.a)(x,2),p=O[0],f=O[1];return Object(d.useEffect)((function(){var e=u.i().on("zoom",(function(e){var t=e.transform,c=t.x,n=t.y,a=t.k;o(a),b(c),f(n)}));e.scaleExtent([.5,2]),u.h(c.current).call(e)}),[]),Object(a.jsx)("svg",{ref:c,viewBox:"-50 0 770 325",width:"550",height:"600",children:Object(a.jsx)("g",{transform:"translate(".concat(h,", ").concat(p,")scale(").concat(i,")"),children:t})})},b=function(e){var t=e.currentArea,c=Object(d.useState)([]),n=Object(s.a)(c,2),r=n[0],o=n[1],b=Object(d.useState)(null),x=Object(s.a)(b,2),O=x[0],p=x[1],f=Object(d.useState)(null),g=Object(s.a)(f,2),m=g[0],v=g[1],y=Object(d.useState)([]),k=Object(s.a)(y,2),S=k[0],N=k[1],w=u.c().center([138.855972,37.2008335]).translate([315,190]).scale(2100);return Object(d.useEffect)((function(){Object(i.a)(l.a.mark((function e(){var t,c,n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/japan_simplify.topojson");case 2:return t=e.sent,e.next=5,t.json();case 5:return c=e.sent,e.next=8,j.a(c,c.objects["N03-21_210101-N03-21_210101"]);case 8:n=e.sent,a=u.d().projection(w),r=[],n.features.map((function(e){r.push({path:a(e),areaCode:e.properties.N03_007})})),o(r),v(n);case 14:case"end":return e.stop()}}),e)})))()}),[]),Object(d.useEffect)((function(){if(m){var e=JSON.parse(JSON.stringify(m)),c=String(t.id).slice(0,-1);e.features.length=0,console.log(t),e.features=m.features.filter((function(e){return t.area===e.properties.N03_003||String(e.properties.N03_007)===c})),console.log("area\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f"),console.log(e);var n=w(u.b(e));N(n),p(t)}}),[t]),r.length?Object(a.jsx)("div",{className:"column is-5",style:{marginLeft:"20px",marginRight:"10px"},children:Object(a.jsx)("div",{className:"box",children:Object(a.jsxs)(h,{width:200,height:500,children:[Object(a.jsx)("g",{children:r.map((function(e,t){return Object(a.jsx)("path",{d:e.path,stroke:"black",strokeWidth:"0.8",strokeOpacity:"0.5",style:{fill:O==e.areaCode?"red":"white"}},t)}))}),S.length>0?Object(a.jsx)("g",{children:Object(a.jsx)("circle",{cx:S[0],cy:S[1],r:"15",strokeWidth:"4",fill:"rgba(255,0,0,0)",stroke:"red"})}):""]})})}):Object(a.jsx)("div",{className:"column is-5",children:Object(a.jsx)("div",{className:"box",children:Object(a.jsx)("p",{children:"loading"})})})},x=function(e){var t=e.scale,c=e.graphWidth,n=e.graphHeight,r=e.location,i=e.label,o="#888",l="left"===r?0:c+40,j=t.range(),u=Object(s.a)(j,2),d=u[0],h=u[1],b=window.innerWidth;return Object(a.jsxs)("g",{children:[Object(a.jsx)("line",{x1:l,y1:d,x2:l,y2:h+2,stroke:o,strokeWidth:"2"}),Object(a.jsxs)("g",{children:[Object(a.jsx)("g",{transform:"translate(-60, ".concat(n/2,") rotate(-90)"),children:Object(a.jsx)("text",{x:l,y:"0",textAnchor:"end",dominantBaseline:"central",fontSize:b>768?"15":"12",children:i})}),t.ticks().map((function(e,c){return Object(a.jsxs)("g",{transform:"translate(".concat(l,", ").concat(t(e),")"),children:[Object(a.jsx)("line",{x1:"0",y1:"0",x2:"left"===r?5:-5,y2:"0",stroke:o}),Object(a.jsx)("text",{x:"left"===r?-8:42,y:"0",textAnchor:"end",dominantBaseline:"central",fill:"black",fontSize:b>768?"12":"10",children:e})]},c)}))]})]})},O=function(e){var t=e.scale,c=e.graphWidth,n=e.graphHeight,r=e.label,i=e.setData,o=e.graphType,l=e.optionData,j=n,u="year"===o?10:20,d=t.range(),h=Object(s.a)(d,2),b=h[0],x=h[1],O=function(e){i("year"===o?e.currentTarget.dataset.id:{id:e.currentTarget.dataset.id,area:e.currentTarget.dataset.name})};return Object(a.jsxs)("g",{children:[Object(a.jsx)("line",{x1:b,y1:j,x2:x+40,y2:j,stroke:"#888"}),Object(a.jsxs)("g",{children:[Object(a.jsx)("g",{transform:"translate(".concat(c/2,", ").concat(j+40,")"),children:Object(a.jsx)("text",{x:"0",y:"0",textAnchor:"end",dominantBaseline:"central",fontSize:"15",children:r})}),t.ticks(u).map((function(e,c){return Object(a.jsx)("g",{transform:"translate(".concat(t(e)+20,", 0)"),children:Object(a.jsx)("text",{x:"0",y:j+15,textAnchor:"middle",dominantBaseline:"central",fontSize:"area"!==o?"12":"5","data-id":"area"!==o||20===c?e:l[c].id,"data-name":"area"===o&&c<20?l[c].area:"",onClick:O,children:"area"!==o||20===c?e:l[c].area})},c)}))]})]})},p=function(e){var t=e.setYear,c=e.colorScale,n=Object(d.useState)([]),r=Object(s.a)(n,2),o=r[0],j=r[1],h=Object(d.useState)([]),b=Object(s.a)(h,2),p=b[0],f=b[1];if(Object(d.useEffect)((function(){Object(i.a)(l.a.mark((function e(){var t,c,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/population_test.json");case 2:return t=e.sent,e.next=5,t.json();case 5:return c=e.sent,j(c),e.next=9,fetch("./data/price_test.json");case 9:return n=e.sent,e.next=12,n.json();case 12:a=e.sent,f(a);case 14:case"end":return e.stop()}}),e)})))()}),[]),0===p.length)return Object(a.jsx)("div",{className:"column is-5",children:"Loading..."});var g=0,m=80,v=400,y=250,k=200+m+v,S=g+50+y,N=u.e().domain(u.a(p,(function(e){return e.year}))).range([0,v]),w=u.e().domain([0,u.a(o,(function(e){return e.population}))[1]]).range([y,0]),H=u.e().domain([0,u.a(p,(function(e){return e.price/1e4}))[1]]).range([y,0]);return Object(a.jsx)("div",{className:"box",children:Object(a.jsx)("div",{children:Object(a.jsxs)("svg",{viewBox:"".concat(-m," ").concat(-g," ").concat(k," ").concat(S),width:k,height:S,children:[Object(a.jsx)(O,{scale:N,graphWidth:v,graphHeight:y,label:"\u5e74",setData:t,graphType:"year"}),Object(a.jsx)(x,{scale:H,graphWidth:v,graphHeight:y,location:"left",label:"\u53d7\u3051\u5165\u308c\u984d"}),Object(a.jsx)(x,{scale:w,graphWidth:v,graphHeight:y,location:"right",label:"\u4eba\u53e3"}),Object(a.jsx)("g",{children:p.map((function(e,t){var n=N(e.year)+20,r=H(e.price/1e4);return Object(a.jsx)("path",{d:"M ".concat(n-10," ").concat(r,"\n                       H ").concat(n+10," V ").concat(y," H ").concat(n-10," \n                      V ").concat(r,"\n                      "),stroke:c("price"),fill:c("price")},e.id)}))}),Object(a.jsx)("g",{children:o.map((function(e,t){var n=t>0?o[t-1]:null;return Object(a.jsxs)("g",{children:[t>0&&Object(a.jsx)("line",{x1:N(n.year)+20,y1:w(n.population),x2:N(e.year)+20,y2:w(e.population),stroke:c("population"),strokeWidth:"3"},10*e.id),Object(a.jsx)("circle",{cx:N(e.year)+20,cy:w(e.population),r:"4",fill:c("population")},e.id)]},100*e.id)}))})]})})})},f=function(e){var t=e.setArea,c=e.year,n=e.colorScale,r=Object(d.useState)([]),o=Object(s.a)(r,2),j=o[0],h=o[1],b=0,p=80,f=500,g=250,m=150+p+f,v=b+50+g;if(Object(d.useEffect)((function(){Object(i.a)(l.a.mark((function e(){var t,c,n,a,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},c=2008,n=20;case 3:if(!(n<33)){e.next=17;break}return a=n<=30?"H"+n:"R"+(n-30),e.next=7,fetch("./data/".concat(a,".json"));case 7:return r=e.sent,e.next=10,r.json();case 10:s=e.sent,console.log(s),t[c]=s,c++;case 14:n++,e.next=3;break;case 17:h(t);case 18:case"end":return e.stop()}}),e)})))()}),[]),0===j.length)return console.log("\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u4e2d"),Object(a.jsx)("div",{});if(!c)return console.log("\u5e74\u5ea6\u304c\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),Object(a.jsx)("div",{className:"column is-5",children:"Loading..."});console.log("data detail"),console.log(j);var y=j[c].map((function(e){return{id:e.id,area:e.area}}));console.log("ojb"),console.log(y);var k=u.e().domain(u.a([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).range([0,f]),S=u.e().domain([0,u.a(j[c],(function(e){return e.price/1e4}))[1]]).range([g,0]),N=u.e().domain([0,u.a(j[c],(function(e){return e.population}))[1]]).range([g,0]);return Object.keys(j).length?Object(a.jsx)("div",{className:"box",children:Object(a.jsx)("div",{children:Object(a.jsxs)("svg",{viewBox:"".concat(-p," ").concat(-b," ").concat(m," ").concat(v),width:m,height:v,children:[Object(a.jsx)(x,{scale:S,graphWidth:f,graphHeight:g,location:"left",label:"\u53d7\u3051\u5165\u308c\u91d1\u984d"}),Object(a.jsx)(O,{scale:k,graphWidth:f,graphHeight:g,label:"\u5e02\u533a\u753a\u6751",setData:t,graphType:"area",optionData:y}),Object(a.jsx)("g",{children:j[c].map((function(e,t){var c=k(t+1)+20,r=S(e.price/1e4);return Object(a.jsx)("path",{d:"M ".concat(c-10," ").concat(r,"\n                   H ").concat(c+10," V ").concat(g," H ").concat(c-10," \n                  V ").concat(r,"\n                  "),fill:n("price")},e.id)}))}),Object(a.jsx)("g",{children:j[c].map((function(e,t){var r=t>0?j[c][t-1]:null;if(t>0)return Object(a.jsxs)("g",{children:[Object(a.jsx)("line",{x1:k(t)+20,y1:N(r.population),x2:k(t+1)+20,y2:N(e.population),stroke:n("population")},10*e.id),Object(a.jsx)("circle",{cx:k(t+1)+20,cy:N(e.population),r:"2",fill:n("population")},e.id)]},100*e.id)}))})]})})}):void 0},g=function(){var e=u.f(u.g),t=Object(d.useState)(null),c=Object(s.a)(t,2),n=c[0],r=c[1],i=Object(d.useState)(null),o=Object(s.a)(i,2),l=o[0],j=o[1];return Object(a.jsxs)("div",{className:"columns is-multiline",style:{marginTop:"10px"},children:[Object(a.jsx)(b,{currentArea:n}),Object(a.jsxs)("div",{className:"column is-6",children:[Object(a.jsx)(p,{setYear:j,colorScale:e}),Object(a.jsx)(f,{setArea:r,year:l,colorScale:e})]})]})},m=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("div",{className:"content has-text-centered",children:Object(a.jsx)("p",{children:"Furu-Vis"})})})},v=(c(172),function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(r,{}),Object(a.jsx)(g,{}),Object(a.jsx)(m,{})]})});Object(n.render)(Object(a.jsx)(v,{}),document.querySelector("#content"))}},[[173,1,2]]]);
//# sourceMappingURL=main.0c2d4323.chunk.js.map